syntax = 'proto3';

import "common.message.proto";
import "files.model.proto";

message QueryFileRequest {
    QueryBuilder query_builder = 1;
    optional string search = 2;
    optional bool include_voided = 4;
    optional RequestContext context = 5;
}

message QueryFileResponse {
    repeated FileMetadata data = 1;
    string metadata = 2; // JSON as string
}

message FileBlobData {
    string name = 1;
    string size = 2;
    string mime_type = 3;
    string filename = 4;
    string original_name = 5;
    bytes buffer = 6;
    string field_name = 7;
}

message CreateFileRequest {
    QueryBuilder query_builder = 1;
    FileBlobData blob = 2;
    string related_model_id = 3;
    string related_model_name = 4;
    string purpose = 5;
    optional string metadata = 6; // JSON as string
    repeated string tags = 7;
    optional string expires_at = 8;
    optional RequestContext context = 9;
}

message GetByHashRequest {
    QueryBuilder query_builder = 1;
    optional RequestContext context = 3;
    string hash = 4;
}

message GetFileResponse {
    FileMetadata data = 1;
    string metadata = 2; // JSON as string
}
message GetBlobResponse {
    FileBlob data = 1;
    string metadata = 2; // JSON as string
}