syntax = 'proto3';


message User { //Minimal cached user info
    string id = 1;
}

message Organization { // Minimal cached organization
    string id = 1;
}

message File {
    string id = 1;
    string filename = 2;
    string original_name = 3;
    string mime_type = 4;
    string size = 5;
    string hash = 6;

    string related_model_id = 7;
    string related_model_name = 8;
    string purpose = 9;

    string uploaded_by_id = 10;
    optional string organization_id = 11;
    string category = 12;

    optional string metadata = 13; // JSON as string
    repeated string tags = 14;

    optional User uploaded_by = 15; // JSON as string
    optional Organization organization = 16; // JSON as string

    string created_at = 17;
    string updated_at = 18;
    optional string last_accessed_at = 19;
    optional string expires_at = 20;
    bool voided = 21;
    repeated FileStorage storages = 22;
}

message FileStorage {
    string id = 1;
    string file_id = 2;
    string provider = 3;
    string remote_id = 4;
    string storage_path = 5;
    optional string storage_url = 6;
    string created_at = 7;
    File file = 8;
}

message FileUsageScope {
    string id = 1;
    string model_name = 2;
    string purpose = 3;
    optional string description = 4;
    string created_at = 5;
    repeated FileUsageRule rules = 6;
}

message FileUsageRule {
    string id = 1;
    string scope_id = 2;
    FileUsageScope scope = 3;
    int32 max_files = 4;
    string created_at = 5;
}